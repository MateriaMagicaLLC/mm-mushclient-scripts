<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Friday, October 24, 2014, 5:28 PM -->
<!-- MuClient version 4.94 -->

<!-- Plugin "vi_starter_pack" generated by Plugin Wizard -->

<muclient>

<plugin
   name="vi_starter_pack"
   author="Jeneya, Ruthgul"
   id="017a906269344dcc9209af11"
   language="Lua"
   purpose="basic aliases, sound triggers, and keystrokes for vi players"
   save_state="y"
   date_written="2014-10-24 17:27:06"
   date_modified="2016-10-10 18:28:03"
   requires="4.71"
   version="1.0"
   >

<description trim="y">

<![CDATA[

~ vi_starter_pack ~

Basic aliases, sound triggers, and keystrokes for vi players.


** REQUIRES **

- play_sounds (plugin id = 4327c10cd9ae383bef04a7fc) must be installed and enabled for this script to be able to play sound files.
- Materia Magica's MSP sound pack (MP3 files), unzipped in the MUSHclient/sounds/msp folder.
- Several other sound files, installed in the MUSHclient/sounds folder.


Aliases:

Often you get messages and are either away from your computer or just busy. These aliases will allow you to go from your input window to the notepad you wish to review. Remember, you can press ctrl + alt + spacebar to get back to input window at any time.

Type NA to go to auction notepad, press ctrl + alt + spacebar to get back to input window.
Type NALL to go to alliance notepad, press ctrl + alt + spacebar to get back to input window.
Type NANN to go to announce notepad, press ctrl + alt + spacebar to get back to input window.
Type NC to go to clan notepad, press ctrl + alt + spacebar to get back to input window.
Type NF to go to form notepad, press ctrl + alt + spacebar to get back to input window.
Type NT to go to tell notepad, press ctrl + alt + spacebar to get back to input window.
Type NP to go to page notepad, press ctrl + alt + spacebar to get back to input window.
Type NNOT to go to page notepad, press ctrl + alt + spacebar to get back to input window.
Type NTLK to go to talk notepad, press ctrl + alt + spacebar to get back to input window.
Type NAR to go to archon notepad, press ctrl + alt + spacebar to get back to input window.
Type NY to go to yell notepad, press ctrl + alt + spacebar to get back to input window.
Type NSHOUT to go to shout notepad, press ctrl + alt + spacebar to get back to input window.
Type NR to go to sight impaired relay notepad, press ctrl + alt + spacebar to get back to input window.
Type NQ to go to quest notepad, press ctrl + alt + spacebar to get back to input window.
Type NS to go to say notepad, press ctrl + alt + spacebar to get back to input window.
Type NSAL to go to salvage notepad, press ctrl + alt + spacebar to get back to input window.


Keystrokes:

Alt + U  reads your health percentage.
Alt + I  reads the percent of spellpoints you have.
Alt + O  reads the percent of stamina you have.
Alt + J  reads the last five messages you have received without going to another window.
Shift + Alt + J  reads the last five pages you have received without going to another window.
Alt + K  reads the last five clan tells that have come in without going to another window.
Alt + L  reads the last five form talks that have come in without going to another window.
Alt + R  reads the last five sight impaired relays that have come in without going to another window.
Alt + A  reads the last five alliance talk messages that have come in without going to another window.
Alt + ;  reads the last five says that have come in without going to another window.
Shift + Alt + ;  reads the last five yells that have come in without going to another window.
Alt + P  reads the last five announcements that have come without going to another window.
Shift + Alt + U  reads the latest auctions without going to another window.
Alt + C  reads the coordinates that you are at.
Alt + ,  checks and reads the victim's percentage of health.
Alt + .  reads the name and percentage of health of the form member in worst need of healing.
Alt + /  reads the health and name of current tank.
Ctrl + D  checks your equipment decay.


Aliases, triggers, keystrokes, help screens, sounds by Jeneya
Plugin and scripts by Ruthgul


Latest version:
http://github.com/MateriaMagicaLLC/mm-mushclient-scripts


]]>

</description>

</plugin>



<!--  Aliases  -->

<aliases>

  <alias
   enabled="y"
   ignore_case="y"
   match="ai"
   send_to="10"
   sequence="100"
  >
  <send>auction inf</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="at *"
   send_to="10"
   sequence="100"
  >
  <send>alliance talk %1</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="na"
   send_to="10"
   sequence="100"
  >
  <send>notepad auction</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nall"
   send_to="10"
   sequence="100"
  >
  <send>notepad alliance</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nann"
   send_to="10"
   sequence="100"
  >
  <send>notepad announcement</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nc"
   send_to="10"
   sequence="100"
  >
  <send>notepad clan</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nf"
   send_to="10"
   sequence="100"
  >
  <send>notepad form</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nt"
   send_to="10"
   sequence="100"
  >
  <send>notepad tell</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="np"
   send_to="10"
   sequence="100"
  >
  <send>notepad page</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nnot"
   send_to="10"
   sequence="100"
  >
  <send>notepad notify</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="ntlk"
   send_to="10"
   sequence="100"
  >
  <send>notepad talk</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nar"
   send_to="10"
   sequence="100"
  >
  <send>notepad archon</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nshout"
   send_to="10"
   sequence="100"
  >
  <send>notepad shout</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="ny"
   send_to="10"
   sequence="100"
  >
  <send>notepad yell</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nq"
   send_to="10"
   sequence="100"
  >
  <send>notepad quests capture</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nr"
   send_to="10"
   sequence="100"
  >
  <send>notepad relay</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="ns"
   send_to="10"
   sequence="100"
  >
  <send>notepad say</send>
  </alias>

  <alias
   enabled="y"
   ignore_case="y"
   match="nsal"
   send_to="10"
   sequence="100"
  >
  <send>notepad salvage</send>
  </alias>


<!--  Plugin help  -->

  <alias
   enabled="y"
   ignore_case="y"
   match="^(|vi\_)starter(|\_)(|pack)(|( |\:)help)$"
   regexp="y"
   script="OnHelp"
  >
  </alias>

</aliases>



<!--  Triggers  -->

<triggers>

  <trigger
   enabled="y"
   match="^You hit .+\, missing .+ and .+ defends .+\, leaving .+ at .+ percent\. You are hit .+\, are missed .+\, and defend .+\.(| )$"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound ping.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="  Visible Exits: *CPK*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound before cpk.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*fountain*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound fountain.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* is barely clinging to life.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound cling.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*sightimpaired*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound sightimpaired.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*your blood freezes*"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound MobDies.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="WARNING: You are in a CHAOTIC PLAYER KILLING room."
   send_to="10"
   sequence="100"
  >
  <send>play a sound cpk room.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You cannot move in that direction."
   send_to="10"
   sequence="100"
  >
  <send>play a sound nope.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="Your disembodied spirit rises from your ravaged corpse."
   send_to="10"
   sequence="100"
  >
  <send>play a sound you have died.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="Welcome to Materia Magica!"
   send_to="10"
   sequence="100"
  >
  <send>play a sound welcome.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*Thank you for visiting Materia Magica.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound Leaving Materia Magica.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="     A signpost points in various directions."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_cowbell.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="     A small crystal has been left here carelessly."
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_bell_riff_up.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="     A weatherbeaten signpost is nailed to the pier here."
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_cowbell.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You ask * for a quest."
   send_to="10"
   sequence="100"
  >
  <send>play a sound quest request.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="* * tells you, 'Congratulations on the completion of thy quest, *!'"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_synth_riff.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="* has recalled to the clan hall!*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound clan tell.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*A small pinkish crystal has been carelessly left here.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_harpsichord_riff.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*All parts of your quest '*' are complete.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound quest complete.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*flee*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound flees.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*Powers have granted thee a Mark.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_shimmer_down.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*The Powers have noticed thy efforts at betterment*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_synth_riff.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*You lose your concentration*"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_sound16.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*You pant and gasp*"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound flee.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="*You sense a hidden life form in*"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound sense life.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*Your Vandemaar's Reagent Bag glows white as it accumulates possessions from the ether*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound reagent bag.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="A calming wave of energy washes over you."
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_dream.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="AUCTION: * bids * gp on *."
   send_to="10"
   sequence="100"
  >
  <send>play a sound bid.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="AUCTION: * has been sold to * for * gp."
   send_to="10"
   sequence="100"
  >
  <send>play a sound item sold.mp3 </send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="AUCTION: * has put * up for auction. Minimum bid is * gp."
   send_to="10"
   sequence="100"
  >
  <send>play a sound auction bell1.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="AUCTION: A * going once (no bid received yet)."
   send_to="10"
   sequence="100"
  >
  <send>play a sound auction bell1.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="AUCTION: No bids received for *. Item has been withdrawn."
   send_to="10"
   sequence="100"
  >
  <send>play a sound auction bell3.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="May the powers guide you!*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound quest complete.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You feel a rushing sense of motion..."
   send_to="10"
   sequence="100"
  >
  <send>play a sound portal here.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You have completed a part of your quest, '*'!"
   send_to="10"
   sequence="100"
  >
  <send>play a sound phase of quest complete.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You have gained the Mark of *!"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_shimmer_up.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You hear a high-pitched shriek as a circular patch of air hardens in front of you."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_sound10.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You hear a high-pitched shriek as the air around you becomes more dense."
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_whoosh2.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You sense a trail * from here."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>play a sound sense a trail.mp3
sapi say %1</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You trip over an unnoticed coil of rope, triggering a snare trap."
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_thunder2.mp3</send>
  </trigger>


<!-- sapi -->

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* asks you if * can join your formation."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 asks to join your form</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* beckons * to follow * with a hopeful expression on * face."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 beckons %2 to form</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* formation has been disbanded."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say form disbanded</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* gives you a *."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 gives you %2</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* joins * formation."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 joins  %2 form</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* makes * the new leader of the formation."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 makes %2 form leader</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* politely refuses your formation request."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 refuses to form</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* stops following *."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 stops follwing %2</send>
  </trigger>

  <trigger
   enabled="y"
   ignore_case="y"
   keep_evaluating="y"
   match="Do you allow this follower (y/N)? "
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say Y or N</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="They are busy at the moment."
   send_to="10"
   sequence="100"
  >
  <send>sapi say busy</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You ask * if you can join * formation."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say you ask to form with %1</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You make * the new leader of the formation."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say you make %1 form leader </send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You politely refuse * formation request."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say refused %1 form request</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You stop following *."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say you stop following %1</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* joins the melee opposing you."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 joins against you</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*That magic would require * spell points to cast.*"
   send_to="10"
   sequence="100"
  >
  <send>sapi say need %1 sp to cast</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*The Powers have noticed thy efforts at betterment*"
   send_to="10"
   sequence="100"
  >
  <send>sapi say The Powers have noticed thy efforts at betterment</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="*You lost the trail.*"
   send_to="10"
   sequence="100"
  >
  <send>play a sound msp/mm_sound16.mp3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="A sudden, strong gust of wind causes * to spin about erratically."
   send_to="10"
   sequence="100"
  >
  <send>sapi say wind unformed %1</send>
  </trigger>

  <trigger
   enabled="y"
   ignore_case="y"
   keep_evaluating="y"
   match="Quest Goal: * [*/* Complete]."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 %2/%3</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="They're in the same place you are."
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say Look where you are! no need to track!</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="You discover a *!"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say you discover a %1</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   ignore_case="y"
   match="* begins attacking *"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 begins attacking %2</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* enters into combat with *."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 combat %2</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* enters *."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %0</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="* has transferred * gemstones into your account."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 has transferred %2 gemstones into your account.</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="A * imp appears before you in a puff of smoke."
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 imp appears</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="A finance imp appears with an ear-splitting BANG!"
   send_to="10"
   sequence="100"
  >
  <send>sapi say finance imp appears</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="The imp tells you, '* has transferred * gold into your * bank account.'"
   send_to="10"
   sequence="100"
  >
  <send>sapi say you were out bid</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="The imp tells you, '* has transferred * reward units to you. Reason: *'"
   send_to="10"
   sequence="100"
  >
  <send>sapi say The imp tells you, '%1 has transferred *%2 reward units to you. Reason: %3 %3'</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="The imp tells you, 'You have been charged the amount of * gold.'"
   send_to="10"
   sequence="100"
  >
  <send>sapi say The imp tells you, 'You have been charged the amount of %1 gold.'</send>
  </trigger>

  <trigger
   enabled="y"
   keep_evaluating="y"
   match="The imp tells you, 'Your bank account has been credited for the amount of *.'"
   send_to="10"
   sequence="100"
  >
  <send>sapi say The imp tells you, 'Your bank account has been credited for the amount of %1.'</send>
  </trigger>


  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) drifts (.+).\n(.+) has fled for (.+) life!\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 flees %2</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) exits (.+).\n(.+) has fled for (.+) life!\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 flees %2</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) leaves (.+).\n(.+) has fled for (.+) life!\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 flees %2</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) panics, and attempts to flee.\n(.+) drifts (.+).\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>notepad write flee %2 flees %3</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) panics, and attempts to flee.\n(.+) exits (.+).\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>notepad write flee %2 flees %3</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) panics, and attempts to flee.\n(.+) leaves (.+).\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>notepad write flee %2 flees %3</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) panics, and attempts to flee.\n(.+) swims (.+).\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>notepad write flee %2 flees %3</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) panics, and attempts to flee.\n(.+) walks (.+).\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>notepad write flee %2 flees %3</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) swims (.+).\n(.+) has fled for (.+) life!\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 flees %2</send>
  </trigger>

  <trigger
   enabled="y"
   group="flees"
   lines_to_match="3"
   keep_evaluating="y"
   match="(.+) walks (.+).\n(.+) has fled for (.+) life!\n\Z"
   multi_line="y"
   regexp="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %1 flees %2</send>
  </trigger>

  <trigger
   enabled="y"
   group="check"
   keep_evaluating="y"
   match="Most decayed equipment - *"
   omit_from_output="y"
   send_to="10"
   sequence="100"
  >
  <send>sapi say %0</send>
  </trigger>

</triggers>



<!--  Scripts  -->

<script>

<![CDATA[

require "wait"
require "gmcphelper"

prev_room = nil
moved = nil


-- plugin stuff

function OnPluginInstall()
  wait.make(function()
    Note("-- " .. GetPluginInfo(GetPluginID(), 1) .. ": type " .. GetPluginInfo(GetPluginID(), 1) .. " help to see info about this plugin --")

    install_accelerators()

    -- give the plugins time to install
    wait.time(3)
    detect_plugins()
  end)
end


function OnPluginListChanged()
  detect_plugins()
end


function detect_plugins()
  play_sounds_detected = play_sounds_present()
end


function OnHelp()
  ColourNote("silver", "black", world.GetPluginInfo(world.GetPluginID(), 3))
  Note("")
  ColourNote("silver", "black", "(this version: " .. os.date("%c", GetPluginInfo(GetPluginID(), 14)) .. ")")
end


function plugin_update_url()
  local t = {
    "https://raw.githubusercontent.com/MateriaMagicaLLC/mm-mushclient-scripts/master/src/vi_starter_pack.xml",
  }
  return (table.concat(t, ";"))
end


function plugin_update_aux_url()
  local t = {
    "https://raw.githubusercontent.com/MateriaMagicaLLC/mm-mushclient-scripts/master/res/MM_Glass_Jar_Falling.mp3,MUSH/sounds",
  }
  return (table.concat(t, ";"))
end


-- handle broadcasts

function OnPluginBroadcast(msg, id, name, text)
  if (id =="b2772cad800b33a6073d9377") -- capture2dworld
  and (name == "capture2dworld")
  and (msg == 2) then
    process_message(text)

  elseif (id == "f67c4339ed0591a5b010d05b") then -- GMCP message
    if (text == "misc.mob_notification") then -- mob notification
      handle_gmcp_mobnotif()

      elseif (text == "char.combat_immunity") then -- immune mob
        handle_immune_mob()

--    elseif (text == "char.exit_blocked_msg") then -- exit blocked
--      handle_gmcp_exitblock()

--    elseif (text == "room.info") then -- room.info
--      process_room()
    end
  end
end


function process_message(text)
  if (play_sounds_detected) then
    local t = utils.split(text, "Ø")

    local chan = t[1]
    local who = t[3]

    if (chan == "announce") then
      Execute("play a sound announce.mp3")

    elseif (chan == "tell") then
      if (string.lower(who) == "you") then
        Execute("play a sound reply.mp3")
      else
        Execute("play a sound tell.mp3")
      end

    elseif (chan == "form") then
      Execute("play a sound formationTalk.mp3")

    elseif (chan == "clan") then
      Execute("play a sound clan tell.mp3")

    elseif (chan == "alliance") then
      Execute("play a sound alliance.mp3")

    elseif (chan == "say") then
      if (string.lower(who) ~= "you") then
        Execute("play a sound say.mp3")
      end
    end
  end
end


function handle_immune_mob()
  Execute("play a sound MM_Glass_Jar_Falling.mp3")
end


function handle_gmcp_mobnotif()
  gmcp_get("misc.mob_notification")
  handle_gmcp_notif("mob_notification")
end


function handle_gmcp_exitblock()
  if (moved) then
    moved = false
    gmcp_get("char.exit_blocked_msg")
    handle_gmcp_notif("exit_blocked_msg", "blocks exit")
  end
end


function handle_gmcp_notif(what, txt)
  local msg = gmcpval(what)
  if (txt) then
    msg = msg .. " " .. txt
  end
  Execute("sapi say " .. msg)
end


function process_room()
  gmcp_get("room.info")

  local uid = gmcpval("num")

  if (uid ~= prev_room) then
    moved = true
    prev_room = uid
  end
end


function gmcp_get(what)
  local res, gmcparg = CallPlugin("f67c4339ed0591a5b010d05b", "gmcpval", what)
  luastmt = "gmcpdata = " .. gmcparg

  assert(loadstring(luastmt or ""))()
end



-- accelerators

function install_accelerators()
  local f
  if (is_accelerators_present()) then
    f = add_accelerator
  else
    f = Accelerator
  end

  f("Alt+U", "score hp", "no")
  f("Alt+O", "score st", "no")
  f("Alt+I", "score sp", "no")
  f("Alt+J", "read captures tell", "no")
  f("Shift+Alt+J", "read captures page", "no")
  f("Alt+K", "read captures clan", "no")
  f("Alt+L", "read captures form", "no")
  f("Alt+R", "read captures relay", "no")
  f("Alt+A", "read captures alliance", "no")
  f("Alt+P", "read captures announce", "no")
  f("Alt+;", "read captures say", "no")
  f("Shift+Alt+;", "read captures yell", "no")
  f("Shift+Alt+U", "read captures auction", "no")
  f("Alt+C", "show coords", "no")
  f("Alt+,", "check victimhp", "no")
  f("Alt+.", "check lowest", "no")
  f("Alt+/", "check tank", "no")
  f("Ctrl+D", "check equipment decay", "no")
end



-- interface with accelerators

function is_accelerators_present()
  local plugin_name = GetPluginInfo("f99134f19ea994a0cc0888d1", 1)

  local res = false

  if (plugin_name == "accelerators") then
    if (GetPluginInfo("f99134f19ea994a0cc0888d1", 17)) then
      res = true
    end
  end

  return res
end


function add_accelerator(keystroke, command, override)
  local res, val

  res, val = CallPlugin("f99134f19ea994a0cc0888d1", "add_accelerator", keystroke, command, override)

  if (res ~= 0) then
    val = false
  end

  return val
end



-- interface with play_sounds

function play_sounds_present()
  return is_plugin_present("play_sounds", "4327c10cd9ae383bef04a7fc")
end


function is_plugin_present(name, id)
  local res = false

  local plugin_name = GetPluginInfo(id, 1)

  if (plugin_name == name) then
    -- is it enabled?
    if (GetPluginInfo(id, 17)) then
      res = true
    end
  end

  return res
end


]]>

</script>

</muclient>
